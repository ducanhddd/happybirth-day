<!DOCTYPE html>
<html lang="vi">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <title>VÅ© trá»¥ 3D Äáº¿m ngÆ°á»£c Dot Matrix + Happy Birthday</title>
Â  Â  <style>
Â  Â  Â  Â  html, body {
Â  Â  Â  Â  Â  Â  width: 100vw; height: 100vh; margin: 0; padding: 0; overflow: hidden;
Â  Â  Â  Â  Â  Â  background: radial-gradient(ellipse at 25% 40%, #735dff 0%, #b85cff 30%, #e46bc2 65%, #ffb86c 100%);
Â  Â  Â  Â  }
Â  Â  Â  Â  #stars3d, #effect-canvas, #wishes {
Â  Â  Â  Â  Â  Â  position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; pointer-events: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  #stars3d { z-index: 1; }
Â  Â  Â  Â  #effect-canvas { z-index: 2; }

Â  Â  Â  Â  /* --- CSS Ä‘Ã£ cÄƒn chá»‰nh láº¡i cho Lá»i chÃºc --- */
Â  Â  Â  Â  #wishes {
Â  Â  Â  Â  Â  Â  z-index: 3;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  font-size: clamp(16px, 2.6vw, 36px); /* KÃ­ch thÆ°á»›c chá»¯ linh hoáº¡t */
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', 'Arial', sans-serif;
Â  Â  Â  Â  Â  Â  text-shadow: 0 2px 12px #e46bc2, 0 4px 32px #b85cff;
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transition: opacity 1.6s;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 0 5vw;
Â  Â  Â  Â  Â  Â  line-height: 1.5;
Â  Â  Â  Â  Â  Â  letter-spacing: 0.02em;
Â  Â  Â  Â  Â  Â  pointer-events: auto;
Â  Â  Â  Â  Â  Â  max-width: 90vw;
Â  Â  Â  Â  Â  Â  margin: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  #wishes-content {
Â  Â  Â  Â  Â  Â  margin-bottom: 2.5vh; /* Khoáº£ng cÃ¡ch Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh */
Â  Â  Â  Â  }
Â  Â  Â  Â  #wishes img {
Â  Â  Â  Â  Â  Â  max-width: 320px; /* TÄƒng kÃ­ch thÆ°á»›c tá»‘i Ä‘a cho áº£nh */
Â  Â  Â  Â  Â  Â  width: 40vw;
Â  Â  Â  Â  Â  Â  max-height: 40vh;
Â  Â  Â  Â  Â  Â  margin: 2.5vh auto 0 auto;
Â  Â  Â  Â  Â  Â  border-radius: 1vw;
Â  Â  Â  Â  Â  Â  box-shadow: 0 6px 32px #b85cff55;
Â  Â  Â  Â  Â  Â  display: none; /* ÄÃ£ áº©n áº£nh */
Â  Â  Â  Â  }
Â  Â  Â  Â  #goto-btn {
Â  Â  Â  Â  Â  Â  margin-top: 3vh; /* Khoáº£ng cÃ¡ch Ä‘Ã£ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh */
Â  Â  Â  Â  Â  Â  padding: 0.8em 2.4em;
Â  Â  Â  Â  Â  Â  font-size: clamp(14px, 1.2em, 20px); /* KÃ­ch thÆ°á»›c chá»¯ linh hoáº¡t */
Â  Â  Â  Â  Â  Â  background: linear-gradient(90deg,#e46bc2,#b85cff,#735dff);
Â  Â  Â  Â  Â  Â  color: #fff;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 2em;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 22px #735dff22;
Â  Â  Â  Â  Â  Â  font-family: inherit;
Â  Â  Â  Â  Â  Â  transition: opacity 0.2s, background 0.3s, transform 0.2s;
Â  Â  Â  Â  Â  Â  opacity: 0.94;
Â  Â  Â  Â  Â  Â  pointer-events: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  #goto-btn:hover {
Â  Â  Â  Â  Â  Â  opacity:1;
Â  Â  Â  Â  Â  Â  background: linear-gradient(90deg,#b85cff,#e46bc2,#ffb86c);
Â  Â  Â  Â  Â  Â  color: #fffde4;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 32px #e46bc288;
Â  Â  Â  Â  Â  Â  transform: scale(1.05);
Â  Â  Â  Â  }
Â  Â  Â  Â  @media (max-width:600px) {
Â  Â  Â  Â  Â  Â  #wishes { padding:0 3vw;}
Â  Â  Â  Â  Â  Â  #wishes img { max-width: 90vw; width: 90vw;}
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- CSS Ä‘Ã£ cÄƒn chá»‰nh láº¡i cho MÃ n hÃ¬nh chá» --- */
Â  Â  Â  Â  #start-screen {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100vw;
Â  Â  Â  Â  Â  Â  height: 100vh;
Â  Â  Â  Â  Â  Â  background: radial-gradient(ellipse at 25% 40%, #735dff 0%, #b85cff 30%, #e46bc2 65%, #ffb86c 100%);
Â  Â  Â  Â  Â  Â  z-index: 10;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  transition: opacity 1.2s ease-in-out;
Â  Â  Â  Â  }
Â  Â  Â  Â  #start-button {
Â  Â  Â  Â  Â  Â  padding: 1.2em 3.5em;
Â  Â  Â  Â  Â  Â  font-size: 1.5em;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #fffde4;
Â  Â  Â  Â  Â  Â  background: linear-gradient(90deg,#b85cff,#e46bc2,#ffb86c);
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 3em;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 28px rgba(0,0,0,0.25);
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Arial, sans-serif;
Â  Â  Â  Â  Â  Â  letter-spacing: 0.05em;
Â  Â  Â  Â  Â  Â  opacity: 0.95;
Â  Â  Â  Â  Â  Â  transition: opacity 0.3s, transform 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  #start-button:hover {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  Â  Â  transform: scale(1.05);
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
<div id="start-screen">
Â  Â  <button id="start-button">Nháº¥n ik ğŸ¥°</button>
</div>

<canvas id="stars3d"></canvas>
<canvas id="effect-canvas"></canvas>
<div id="wishes">
Â  Â  <div id="wishes-content"></div>
Â  Â  <img id="wish-img" src="" alt="Lá»i chÃºc" style="display:none">
Â  Â  <button id="goto-btn" style="display:none">Xem quÃ  Ä‘áº·c biá»‡t ğŸ</button>
</div>
<audio id="bg-music" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" loop></audio>
<script>
// --- VÅ¨ TRá»¤ 3D ---
const starsCanvas = document.getElementById('stars3d');
const sctx = starsCanvas.getContext('2d');
let w = window.innerWidth, h = window.innerHeight;
starsCanvas.width = w;
starsCanvas.height = h;

const STAR_NUM = 350;
const STAR_MIN_Z = 0.17;
const STAR_MAX_Z = 1.15;
let stars = [];
function lerp(a, b, t) { return a + (b - a) * t; }
function randomStar() {
Â  Â  const angle = Math.random() * 2 * Math.PI;
Â  Â  const distance = Math.random() * Math.min(w, h) * 0.49 + 40;
Â  Â  const z = Math.random() * (STAR_MAX_Z - STAR_MIN_Z) + STAR_MIN_Z;
Â  Â  return {
Â  Â  Â  Â  baseAngle: angle,
Â  Â  Â  Â  baseDistance: distance,
Â  Â  Â  Â  z: z,
Â  Â  Â  Â  speed: 0.0014 + Math.random()*0.0021,
Â  Â  Â  Â  size: Math.random() < 0.1 ? 1.4 + Math.random() * 1.1 : (Math.random() < 0.4 ? 0.7 : 0.4),
Â  Â  Â  Â  twinkle: 0.5 + Math.random()*0.7
Â  Â  };
}
function resetStar(star, behind = false) {
Â  Â  star.baseAngle = Math.random() * 2 * Math.PI;
Â  Â  star.baseDistance = Math.random() * Math.min(w, h) * 0.49 + 40;
Â  Â  star.z = behind ? STAR_MAX_Z : STAR_MIN_Z;
Â  Â  star.size = Math.random() < 0.1 ? 1.4 + Math.random() * 1.1 : (Math.random() < 0.4 ? 0.7 : 0.4);
Â  Â  star.twinkle = 0.5 + Math.random()*0.7;
}
function initStars() {
Â  Â  stars = [];
Â  Â  for(let i=0; i<STAR_NUM; i++) stars.push(randomStar());
}
initStars();

function drawStars() {
Â  Â  sctx.clearRect(0,0,w,h);
Â  Â  for(let star of stars) {
Â  Â  Â  Â  let z = star.z, scale = 1 / z;
Â  Â  Â  Â  let px = w/2 + Math.cos(star.baseAngle) * star.baseDistance * scale;
Â  Â  Â  Â  let py = h/2 + Math.sin(star.baseAngle) * star.baseDistance * scale * 0.7;
Â  Â  Â  Â  let ps = star.size * scale * 0.85;
Â  Â  Â  Â  let twinkleAlpha = lerp(0.5, 1, Math.abs(Math.sin(Date.now()/750 + px + py) * star.twinkle));
Â  Â  Â  Â  let baseAlpha = Math.max(0.35, 1.18 - z*1.13);
Â  Â  Â  Â  let alpha = baseAlpha * twinkleAlpha;
Â  Â  Â  Â  sctx.save();
Â  Â  Â  Â  sctx.globalAlpha = alpha;
Â  Â  Â  Â  sctx.shadowColor = "#fff";
Â  Â  Â  Â  sctx.shadowBlur = ps > 1 ? 3 : 1;
Â  Â  Â  Â  sctx.fillStyle = "#fff";
Â  Â  Â  Â  sctx.beginPath();
Â  Â  Â  Â  sctx.arc(px, py, ps, 0, 2*Math.PI, false);
Â  Â  Â  Â  sctx.fill();
Â  Â  Â  Â  sctx.restore();
Â  Â  }
}
function animateStars() {
Â  Â  for(let star of stars) {
Â  Â  Â  Â  star.z -= star.speed;
Â  Â  Â  Â  if(star.z < STAR_MIN_Z) resetStar(star, true);
Â  Â  }
Â  Â  drawStars();
Â  Â  requestAnimationFrame(animateStars);
}
animateStars();

// -------- DOT MATRIX (Sá» & CHá»®) ---------
const effectCanvas = document.getElementById('effect-canvas');
const cctx = effectCanvas.getContext('2d');
effectCanvas.width = w; effectCanvas.height = h;

// Dot matrix cho sá»‘ (Ä‘áº¿m ngÆ°á»£c)
const DOT_ROWS_NUM = 36, DOT_COLS_NUM = 30;
function getDotSizeNum() { return Math.min(w,h) * 0.018; }
function getDotGapNum() { return getDotSizeNum() * 0.40; }
const DOT_COLOR = "#fff";

function getMatrixDots(number) {
Â  Â  let fontCanvas = document.createElement('canvas');
Â  Â  let fctx = fontCanvas.getContext('2d');
Â  Â  fontCanvas.width = DOT_COLS_NUM*12;
Â  Â  fontCanvas.height = DOT_ROWS_NUM*12;
Â  Â  fctx.clearRect(0,0,fontCanvas.width,fontCanvas.height);
Â  Â  fctx.font = `bold ${fontCanvas.height*0.95}px Arial`;
Â  Â  fctx.textAlign = "center";
Â  Â  fctx.textBaseline = "middle";
Â  Â  fctx.fillStyle = "#fff";
Â  Â  fctx.fillText(number, fontCanvas.width/2, fontCanvas.height/2);

Â  Â  let imgData = fctx.getImageData(0,0,fontCanvas.width,fontCanvas.height).data;
Â  Â  let dots = [];
Â  Â  for(let r=0; r<DOT_ROWS_NUM; r++) for(let c=0; c<DOT_COLS_NUM; c++) {
Â  Â  Â  Â  let cx = Math.round((c+0.5)*fontCanvas.width/DOT_COLS_NUM);
Â  Â  Â  Â  let cy = Math.round((r+0.5)*fontCanvas.height/DOT_ROWS_NUM);
Â  Â  Â  Â  let idx = (cy*fontCanvas.width + cx)*4;
Â  Â  Â  Â  let brightness = imgData[idx]+imgData[idx+1]+imgData[idx+2];
Â  Â  Â  Â  if (brightness > 380) {
Â  Â  Â  Â  Â  Â  dots.push({x: c, y: r});
Â  Â  Â  Â  }
Â  Â  }
Â  Â  return dots;
}

function drawDots(dotArr) {
Â  Â  for (let dot of dotArr) {
Â  Â  Â  Â  cctx.save();
Â  Â  Â  Â  cctx.globalAlpha = dot.alpha;
Â  Â  Â  Â  cctx.beginPath();
Â  Â  Â  Â  cctx.arc(dot.x, dot.y, dot.r, 0, 2*Math.PI, false);
Â  Â  Â  Â  cctx.fillStyle = DOT_COLOR;
Â  Â  Â  Â  cctx.shadowColor = "#fff";
Â  Â  Â  Â  cctx.shadowBlur = 18 * dot.scale;
Â  Â  Â  Â  cctx.fill();
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Add extra glow for better visibility
Â  Â  Â  Â  cctx.beginPath();
Â  Â  Â  Â  cctx.arc(dot.x, dot.y, dot.r * 0.6, 0, 2*Math.PI, false);
Â  Â  Â  Â  cctx.fillStyle = "#ffffff";
Â  Â  Â  Â  cctx.globalAlpha = dot.alpha * 0.8;
Â  Â  Â  Â  cctx.fill();
Â  Â  Â  Â Â 
Â  Â  Â  Â  cctx.restore();
Â  Â  }
}

// --- Dot matrix chá»¯ (Happy Birthday To You) ---
const LETTER_MATRIX = {
Â  Â  H: [
Â  Â  Â  Â  "xxxxÂ  Â  Â  xxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â  xxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â  xxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â  xxxx",
Â  Â  Â  Â  "xxxxxxxxxxxxxx",
Â  Â  Â  Â  "xxxxxxxxxxxxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â  xxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â  xxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â  xxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â  xxxx"
Â  Â  ],
Â  Â  A: [
Â  Â  Â  Â  "Â  Â  Â  Â  xxÂ  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  xxxxÂ  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â xxxxxxÂ  Â  Â ",
Â  Â  Â  Â  "Â  Â  xxxxxxxxÂ  Â  ",
Â  Â  Â  Â  "Â  Â xxxxÂ  xxxxÂ  Â ",
Â  Â  Â  Â  "Â  xxxxxxxxxxxxÂ  ",
Â  Â  Â  Â  " xxxxxxxxxxxxxx ",
Â  Â  Â  Â  "xxxxÂ  Â  Â  Â  xxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â  Â  xxxx"
Â  Â  ],
Â  Â  P: [
Â  Â  Â  Â  "xxxxxxxxxxxÂ  ",
Â  Â  Â  Â  "xxxxxxxxxxxx ",
Â  Â  Â  Â  "xxxxÂ  Â  Â xxxx",
Â  Â  Â  Â  "xxxxÂ  Â  Â xxxx",
Â  Â  Â  Â  "xxxxxxxxxxxx ",
Â  Â  Â  Â  "xxxxxxxxxxxÂ  ",
Â  Â  Â  Â  "xxxxÂ  Â  Â  Â  Â ",
Â  Â  Â  Â  "xxxxÂ  Â  Â  Â  Â ",
Â  Â  Â  Â  "xxxxÂ  Â  Â  Â  Â ",
Â  Â  Â  Â  "xxxxÂ  Â  Â  Â  Â "
Â  Â  ],
Â  Â  Y: [
Â  Â  Â  Â  "xxxÂ  Â  Â  Â  xxx ",
Â  Â  Â  Â  " xxxÂ  Â  Â  xxxÂ  ",
Â  Â  Â  Â  "Â  xxxÂ  Â  xxxÂ  Â ",
Â  Â  Â  Â  "Â  Â xxxÂ  xxxÂ  Â  ",
Â  Â  Â  Â  "Â  Â  Â xxxxÂ  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â xxxxÂ  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â xxxxÂ  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â xxxxÂ  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â xxxxÂ  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â xxxxÂ  Â  Â  "
Â  Â  ],
Â  Â  B: [
Â  Â  Â  Â  "xxxxxxxxxÂ  ",
Â  Â  Â  Â  "xxxxxxxxxx ",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxxxxxxxx ",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxxxxxxxx ",
Â  Â  Â  Â  "xxxxxxxxxÂ  "
Â  Â  ],
Â  Â  I: [
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx",
Â  Â  Â  Â  "xxxx"
Â  Â  ],
Â  Â  R: [
Â  Â  Â  Â  "xxxxxxxxÂ  ",
Â  Â  Â  Â  "xxxxxxxxx ",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxxxxxxxÂ  ",
Â  Â  Â  Â  "xxxxxxxÂ  Â ",
Â  Â  Â  Â  "xxÂ  Â xxÂ  Â ",
Â  Â  Â  Â  "xxÂ  Â  xxÂ  ",
Â  Â  Â  Â  "xxÂ  Â  xxÂ  ",
Â  Â  Â  Â  "xxÂ  Â  xxÂ  "
Â  Â  ],
Â  Â  T: [
Â  Â  Â  Â  "xxxxxxxxxx",
Â  Â  Â  Â  "xxxxxxxxxx",
Â  Â  Â  Â  "Â  Â xxÂ  Â  Â ",
Â  Â  Â  Â  "Â  Â xxÂ  Â  Â ",
Â  Â  Â  Â  "Â  Â xxÂ  Â  Â ",
Â  Â  Â  Â  "Â  Â xxÂ  Â  Â ",
Â  Â  Â  Â  "Â  Â xxÂ  Â  Â ",
Â  Â  Â  Â  "Â  Â xxÂ  Â  Â ",
Â  Â  Â  Â  "Â  Â xxÂ  Â  Â ",
Â  Â  Â  Â  "Â  Â xxÂ  Â  Â "
Â  Â  ],
Â  Â  D: [
Â  Â  Â  Â  "xxxxxxxxxÂ  ",
Â  Â  Â  Â  "xxxxxxxxxx ",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxÂ  Â  Â  xxx",
Â  Â  Â  Â  "xxxxxxxxxx ",
Â  Â  Â  Â  "xxxxxxxxxÂ  "
Â  Â  ],
Â  Â  O: [
Â  Â  Â  Â  "Â  Â xxxxxxÂ  Â ",
Â  Â  Â  Â  "Â  xxxÂ  xxxÂ  ",
Â  Â  Â  Â  " xxÂ  Â  Â  xx ",
Â  Â  Â  Â  " xxÂ  Â  Â  xx ",
Â  Â  Â  Â  " xxÂ  Â  Â  xx ",
Â  Â  Â  Â  " xxÂ  Â  Â  xx ",
Â  Â  Â  Â  " xxÂ  Â  Â  xx ",
Â  Â  Â  Â  " xxÂ  Â  Â  xx ",
Â  Â  Â  Â  "Â  xxxÂ  xxxÂ  ",
Â  Â  Â  Â  "Â  Â xxxxxxÂ  Â "
Â  Â  ],
Â  Â  U: [
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  "xxÂ  Â  Â  xx",
Â  Â  Â  Â  " xxxxxxxx ",
Â  Â  Â  Â  "Â  xxxxxxÂ  "
Â  Â  ],
Â  Â  ' ': [
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  ",
Â  Â  Â  Â  "Â  Â  Â  "
Â  Â  ]
};

function getPatternForText(text) {
Â  Â  let result = [];
Â  Â  let offsetCol = 0;
Â  Â  text = text.toUpperCase();
Â  Â  for (let i = 0; i < text.length; ++i) {
Â  Â  Â  Â  let ch = text[i];
Â  Â  Â  Â  let matrix = LETTER_MATRIX[ch] || LETTER_MATRIX[' '];
Â  Â  Â  Â  for (let row = 0; row < matrix.length; ++row) {
Â  Â  Â  Â  Â  Â  for (let col = 0; col < matrix[row].length; ++col) {
Â  Â  Â  Â  Â  Â  Â  Â  if (matrix[row][col] === "x") {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  result.push({col: offsetCol + col, row});
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  offsetCol += matrix[0].length + 2; // space between letters
Â  Â  }
Â  Â  return result;
}

function getDotSizeText() { return Math.min(w,h) * 0.013; }
function getDotGapText() { return getDotSizeText() * 0.36; }

function getPatternCoords(patternInfo) {
Â  Â  const DOT_SIZE = getDotSizeText();
Â  Â  const DOT_GAP = getDotGapText();
Â  Â  let minCol = Math.min(...patternInfo.map(d => d.col));
Â  Â  let maxCol = Math.max(...patternInfo.map(d => d.col));
Â  Â  let minRow = Math.min(...patternInfo.map(d => d.row));
Â  Â  let maxRow = Math.max(...patternInfo.map(d => d.row));
Â  Â  let cols = maxCol - minCol + 1;
Â  Â  let rows = maxRow - minRow + 1;
Â  Â  let fullW = cols * (DOT_SIZE + DOT_GAP);
Â  Â  let fullH = rows * (DOT_SIZE + DOT_GAP);

Â  Â  let offsetX = w/2 - fullW/2 - minCol * (DOT_SIZE + DOT_GAP);
Â  Â  let offsetY = h/2 - fullH/2 - minRow * (DOT_SIZE + DOT_GAP);

Â  Â  return patternInfo.map(d => ({
Â  Â  Â  Â  x: offsetX + d.col * (DOT_SIZE + DOT_GAP),
Â  Â  Â  Â  y: offsetY + d.row * (DOT_SIZE + DOT_GAP),
Â  Â  Â  Â  r: DOT_SIZE/2
Â  Â  }));
}

// --- Animation logic ---
let showDots = [];
let animating = false;
let currentNum = 3;
let currentLine = 0;
const LINES = ["HAPPY", "BIRTHDAY", "TO YOU"];

// Lá»i chÃºc cuá»‘i, chÃ¨n áº£nh vÃ  link tÃ¹y Ã½
const WISHES_TEXT = `ChÃºc báº¡n tuá»•i má»›i tháº­t nhiá»u sá»©c khá»e, háº¡nh phÃºc vÃ  thÃ nh cÃ´ng!<br>
LuÃ´n luÃ´n ráº¡ng rá»¡, bÃ¬nh an vÃ  gáº·p tháº­t nhiá»u may máº¯n trÃªn má»i hÃ nh trÃ¬nh nhÃ©! ğŸ‚ğŸ‰`;
const WISHES_IMG = ""; // ÄÃ£ loáº¡i bá» Ä‘Æ°á»ng dáº«n áº£nh
const WISHES_BTN_TEXT = "Xem quÃ  Ä‘áº·c biá»‡t ğŸ";
const WISHES_BTN_LINK = "https://www.google.com"; // Thay link báº¡n muá»‘n

function animateIn(dots, isText, callback) {
Â  Â  animating = true;
Â  Â  let centerX = w/2, centerY = h/2;
Â  Â  let DOT_SIZE = isText ? getDotSizeText() : getDotSizeNum();
Â  Â  let startDots = [];
Â  Â  for(let coord of dots) {
Â  Â  Â  Â  let angle = Math.random() * 2 * Math.PI;
Â  Â  Â  Â  let radius = Math.random() * Math.max(w, h)/2 + 120;
Â  Â  Â  Â  startDots.push({
Â  Â  Â  Â  Â  Â  x: centerX + Math.cos(angle)*radius,
Â  Â  Â  Â  Â  Â  y: centerY + Math.sin(angle)*radius,
Â  Â  Â  Â  Â  Â  tx: coord.x,
Â  Â  Â  Â  Â  Â  ty: coord.y,
Â  Â  Â  Â  Â  Â  r: DOT_SIZE/2,
Â  Â  Â  Â  Â  Â  alpha: 0,
Â  Â  Â  Â  Â  Â  scale: 0.5
Â  Â  Â  Â  });
Â  Â  }
Â  Â  let frame = 0, maxFrame = 38;
Â  Â  function frameIn() {
Â  Â  Â  Â  frame++;
Â  Â  Â  Â  for(let dot of startDots) {
Â  Â  Â  Â  Â  Â  dot.x = lerp(dot.x, dot.tx, 0.22);
Â  Â  Â  Â  Â  Â  dot.y = lerp(dot.y, dot.ty, 0.22);
Â  Â  Â  Â  Â  Â  dot.alpha = lerp(dot.alpha, 1, 0.12);
Â  Â  Â  Â  Â  Â  dot.scale = lerp(dot.scale, 1, 0.16);
Â  Â  Â  Â  Â  Â  dot.r = DOT_SIZE/2 * dot.scale;
Â  Â  Â  Â  }
Â  Â  Â  Â  cctx.clearRect(0,0,effectCanvas.width,effectCanvas.height);
Â  Â  Â  Â  drawDots(startDots);
Â  Â  Â  Â  if (frame < maxFrame) requestAnimationFrame(frameIn);
Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  showDots = startDots.map(d => ({...d}));
Â  Â  Â  Â  Â  Â  animating = false;
Â  Â  Â  Â  Â  Â  callback && callback();
Â  Â  Â  Â  }
Â  Â  }
Â  Â  frameIn();
}

function animateOut(isText, callback) {
Â  Â  animating = true;
Â  Â  let DOT_SIZE = isText ? getDotSizeText() : getDotSizeNum();
Â  Â  let frame = 0, maxFrame = 29;
Â  Â  function frameOut() {
Â  Â  Â  Â  frame++;
Â  Â  Â  Â  for (let dot of showDots) {
Â  Â  Â  Â  Â  Â  let angle = Math.random() * 2 * Math.PI;
Â  Â  Â  Â  Â  Â  let speed = 6 + Math.random()*7;
Â  Â  Â  Â  Â  Â  dot.x += Math.cos(angle) * speed;
Â  Â  Â  Â  Â  Â  dot.y += Math.sin(angle) * speed;
Â  Â  Â  Â  Â  Â  dot.alpha *= 0.92;
Â  Â  Â  Â  Â  Â  dot.scale *= 0.96;
Â  Â  Â  Â  Â  Â  dot.r = DOT_SIZE/2 * dot.scale;
Â  Â  Â  Â  }
Â  Â  Â  Â  cctx.clearRect(0,0,effectCanvas.width,effectCanvas.height);
Â  Â  Â  Â  drawDots(showDots);
Â  Â  Â  Â  if (frame < maxFrame) requestAnimationFrame(frameOut);
Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  Â  animating = false;
Â  Â  Â  Â  Â  Â  callback && callback();
Â  Â  Â  Â  }
Â  Â  }
Â  Â  frameOut();
}

// --- Äáº¿m ngÆ°á»£c rá»“i hiá»‡n chá»¯ ---
function startCountdown(num) {
Â  Â  if (num < 1) {
Â  Â  Â  Â  setTimeout(()=>{
Â  Â  Â  Â  Â  Â  cctx.clearRect(0,0,effectCanvas.width,effectCanvas.height);
Â  Â  Â  Â  Â  Â  // Báº¯t Ä‘áº§u hiá»‡u á»©ng dÃ²ng chá»¯
Â  Â  Â  Â  Â  Â  setTimeout(()=>showLine(0), 300);
Â  Â  Â  Â  }, 350);
Â  Â  Â  Â  return;
Â  Â  }
Â  Â  currentNum = num;
Â  Â  let matrixDots = getMatrixDots(num.toString());
Â  Â  let dotSize = getDotSizeNum(), dotGap = getDotGapNum();
Â  Â  let fullW = DOT_COLS_NUM * (dotSize+dotGap);
Â  Â  let fullH = DOT_ROWS_NUM * (dotSize+dotGap);
Â  Â  let x0 = w/2 - fullW/2, y0 = h/2 - fullH/2;
Â  Â  let dots = matrixDots.map(d => ({
Â  Â  Â  Â  x: x0 + d.x*(dotSize+dotGap),
Â  Â  Â  Â  y: y0 + d.y*(dotSize+dotGap),
Â  Â  Â  Â  r: dotSize/2
Â  Â  }));
Â  Â  animateIn(dots, false, ()=>{
Â  Â  Â  Â  setTimeout(()=>{
Â  Â  Â  Â  Â  Â  animateOut(false, ()=>{
Â  Â  Â  Â  Â  Â  Â  Â  startCountdown(num-1);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }, 900);
Â  Â  });
}

function showLine(idx) {
Â  Â  currentLine = idx;
Â  Â  let patternInfo = getPatternForText(LINES[idx]);
Â  Â  let patternCoords = getPatternCoords(patternInfo);
Â  Â  animateIn(patternCoords, true, ()=>{
Â  Â  Â  Â  setTimeout(()=>{
Â  Â  Â  Â  Â  Â  animateOut(true, ()=>{
Â  Â  Â  Â  Â  Â  Â  Â  if (currentLine + 1 < LINES.length) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showLine(currentLine + 1);
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // ÄÃ£ xong TO YOU, hiá»‡n lá»i chÃºc
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showWishes();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }, 1200);
Â  Â  });
}

// --- Lá»i chÃºc cuá»‘i ---
const wishesDiv = document.getElementById('wishes');
const wishesContentDiv = document.getElementById('wishes-content');
const wishImg = document.getElementById('wish-img');
const gotoBtn = document.getElementById('goto-btn');
function showWishes() {
Â  Â  wishesContentDiv.innerHTML = WISHES_TEXT;
Â  Â  // áº¢nh
Â  Â  if(WISHES_IMG && WISHES_IMG.length > 5) {
Â  Â  Â  Â  wishImg.src = WISHES_IMG;
Â  Â  Â  Â  wishImg.style.display = "block";
Â  Â  } else {
Â  Â  Â  Â  wishImg.style.display = "none";
Â  Â  }
Â  Â  // NÃºt
Â  Â  if(WISHES_BTN_LINK && WISHES_BTN_TEXT) {
Â  Â  Â  Â  gotoBtn.textContent = WISHES_BTN_TEXT;
Â  Â  Â  Â  gotoBtn.style.display = "inline-block";
Â  Â  Â  Â  gotoBtn.onclick = ()=>window.open(WISHES_BTN_LINK, "_blank");
Â  Â  } else {
Â  Â  Â  Â  gotoBtn.style.display = "none";
Â  Â  }
Â  Â  wishesDiv.style.opacity = "0";
Â  Â  wishesDiv.style.display = "flex";
Â  Â  setTimeout(()=>{
Â  Â  Â  Â  wishesDiv.style.opacity = "1";
Â  Â  }, 80);
}

// Responsive
window.addEventListener('resize', ()=>{
Â  Â  w = window.innerWidth; h = window.innerHeight;
Â  Â  starsCanvas.width = w; starsCanvas.height = h;
Â  Â  effectCanvas.width = w; effectCanvas.height = h;
Â  Â  initStars();
Â  Â  if (animating) return;
Â  Â  if(currentNum > 0) {
Â  Â  Â  Â  let matrixDots = getMatrixDots(currentNum.toString());
Â  Â  Â  Â  let dotSize = getDotSizeNum(), dotGap = getDotGapNum();
Â  Â  Â  Â  let fullW = DOT_COLS_NUM * (dotSize+dotGap);
Â  Â  Â  Â  let fullH = DOT_ROWS_NUM * (dotSize+dotGap);
Â  Â  Â  Â  let x0 = w/2 - fullW/2, y0 = h/2 - fullH/2;
Â  Â  Â  Â  let dots = matrixDots.map(d => ({
Â  Â  Â  Â  Â  Â  x: x0 + d.x*(dotSize+dotGap),
Â  Â  Â  Â  Â  Â  y: y0 + d.y*(dotSize+dotGap),
Â  Â  Â  Â  Â  Â  r: dotSize/2, alpha: 1, scale: 1
Â  Â  Â  Â  }));
Â  Â  Â  Â  showDots = dots;
Â  Â  Â  Â  cctx.clearRect(0,0,effectCanvas.width,effectCanvas.height);
Â  Â  Â  Â  drawDots(showDots);
Â  Â  } else if (currentLine < LINES.length) {
Â  Â  Â  Â  let patternInfo = getPatternForText(LINES[currentLine]);
Â  Â  Â  Â  let patternCoords = getPatternCoords(patternInfo);
Â  Â  Â  Â  showDots = patternCoords.map(d => ({...d, alpha: 1, scale: 1}));
Â  Â  Â  Â  cctx.clearRect(0,0,effectCanvas.width,effectCanvas.height);
Â  Â  Â  Â  drawDots(showDots);
Â  Â  }
});

// Nháº¡c ná»n auto play
const bgMusic = document.getElementById('bg-music');
function playMusic() {
Â  Â  bgMusic.volume = 0.45;
Â  Â  bgMusic.play().catch(() => {
Â  Â  Â  Â  // Má»™t sá»‘ trÃ¬nh duyá»‡t yÃªu cáº§u tÆ°Æ¡ng tÃ¡c, sáº½ play khi cÃ³ click
Â  Â  Â  Â  document.body.addEventListener('pointerdown', function once() {
Â  Â  Â  Â  Â  Â  bgMusic.play();
Â  Â  Â  Â  Â  Â  document.body.removeEventListener('pointerdown', once);
Â  Â  Â  Â  });
Â  Â  });
}

function launch() {
Â  Â  effectCanvas.width = starsCanvas.width = w;
Â  Â  effectCanvas.height = starsCanvas.height = h;
Â  Â  wishesDiv.style.display = "none";
Â  Â  wishesDiv.style.opacity = 0;
Â  Â  startCountdown(3);
Â  Â  playMusic();
}

// --- JavaScript cho MÃ n hÃ¬nh chá» ---
const startScreen = document.getElementById('start-screen');
const startButton = document.getElementById('start-button');

startButton.addEventListener('click', () => {
Â  Â  // áº¨n mÃ n hÃ¬nh chá»
Â  Â  startScreen.style.opacity = '0';
Â  Â  setTimeout(() => {
Â  Â  Â  Â  startScreen.style.display = 'none';
Â  Â  }, 1200);

Â  Â  // Báº¯t Ä‘áº§u cÃ¡c hiá»‡u á»©ng vÃ  nháº¡c
Â  Â  launch();
});
</script>
</body>
</html>
